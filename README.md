# ansible-init-os

## 定义inventory

```
[all]
192.168.122.73
```

## 执行

```
ansible-playbook -i inventory test.yml
PLAY [all] ***********************************************************************************************************************************************

TASK [Gathering Facts] ***********************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : apt更新缓存刷新] *******************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 删除ubuntu默认安装] ****************************************************************************************************************************
changed: [192.168.122.73] => (item=ufw)
changed: [192.168.122.73] => (item=lxd)
changed: [192.168.122.73] => (item=lxd-client)
changed: [192.168.122.73] => (item=lxcfs)
changed: [192.168.122.73] => (item=lxc-common)

TASK [initsys : 安装 ubuntu/debian基础软件] ********************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 准备 journal 日志相关目录] ***********************************************************************************************************************
ok: [192.168.122.73] => (item=/etc/systemd/journald.conf.d)
ok: [192.168.122.73] => (item=/var/log/journal)

TASK [initsys : 优化设置 journal 日志] *************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 重启 journald 服务] **************************************************************************************************************************
changed: [192.168.122.73]

TASK [initsys : Configuration iptables] ******************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 删除centos默认安装] ****************************************************************************************************************************
skipping: [192.168.122.73] => (item=firewalld) 
skipping: [192.168.122.73] => (item=python-firewall) 
skipping: [192.168.122.73] => (item=firewalld-filesystem) 

TASK [initsys : 安装基础软件包] *********************************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 临时关闭 selinux] ****************************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 永久关闭 selinux] ****************************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 禁止rsyslog获取journald日志1] ******************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 禁止rsyslog获取journald日志2] ******************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 重启rsyslog服务] *****************************************************************************************************************************
skipping: [192.168.122.73]

TASK [initsys : 禁用系统 swap] *******************************************************************************************************************************
changed: [192.168.122.73]

TASK [initsys : 删除fstab swap 相关配置] ***********************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 转换内核版本为浮点数] ******************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 加载内核模块] **********************************************************************************************************************************
ok: [192.168.122.73] => (item=br_netfilter)
ok: [192.168.122.73] => (item=ip_vs)
ok: [192.168.122.73] => (item=ip_vs_rr)
ok: [192.168.122.73] => (item=ip_vs_wrr)
ok: [192.168.122.73] => (item=ip_vs_sh)
ok: [192.168.122.73] => (item=nf_conntrack)

TASK [initsys : 尝试加载nf_conntrack_ipv4] *******************************************************************************************************************
changed: [192.168.122.73]

TASK [initsys : 启用systemd自动加载模块服务] ***********************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 增加内核模块开机加载配置] ****************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 设置系统参数] **********************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 生效系统参数] **********************************************************************************************************************************
changed: [192.168.122.73]

TASK [initsys : 创建 systemd 配置目录] *************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 设置系统 ulimits] ****************************************************************************************************************************
ok: [192.168.122.73]

TASK [initsys : 把SCTP列入内核模块黑名单] **************************************************************************************************************************
ok: [192.168.122.73]

TASK [initmotd : Copy color.awk file to remote hosts] ****************************************************************************************************
ok: [192.168.122.73]

TASK [initmotd : Copy dynmotd file to remote hosts] ******************************************************************************************************
ok: [192.168.122.73]

TASK [initmotd : Install package] ************************************************************************************************************************
ok: [192.168.122.73]

TASK [initmotd : Modify PATH] ****************************************************************************************************************************
ok: [192.168.122.73]

PLAY RECAP ***********************************************************************************************************************************************
192.168.122.73             : ok=23   changed=5    unreachable=0    failed=0    skipped=8    rescued=0    ignored=0 
```
